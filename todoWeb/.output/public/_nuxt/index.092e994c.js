import{P as q,r,U as R,b as J,B as x,V as Q,d as p,q as m,W as B,K as L,L as Y,c as ee,E as te,o as oe,X as ne,R as ae,Y as se,F as le,D as ce}from"./entry.846cef3d.js";import{M as ie,X as re,e as z,n as k,t as C,b as N,Y as A,E as ue,Z as de,V as X,c as $,R as K,_ as ve,r as M,w as F,m as g,$ as fe,I as ye}from"./index.71b9cbcb.js";function me(e,{args:t=[],done:o,canceled:l}){if(e){const n=e.apply(null,t);ie(n)?n.then(a=>{a?o():l&&l()}).catch(re):n?o():l&&l()}else o()}let he=2e3;const Ie=()=>++he;function Oe(e){const t=q();t&&z(t.proxy,e)}const Ce={show:Boolean,zIndex:k,overlay:C,duration:k,teleport:[String,Object],lockScroll:C,lazyRender:C,beforeClose:Function,overlayStyle:Object,overlayClass:N,transitionAppear:Boolean,closeOnClickOverlay:C};function Pe(e,t){return e>t?"horizontal":t>e?"vertical":""}function we(){const e=r(0),t=r(0),o=r(0),l=r(0),n=r(0),a=r(0),s=r(""),i=r(!0),P=()=>s.value==="vertical",O=()=>s.value==="horizontal",u=()=>{o.value=0,l.value=0,n.value=0,a.value=0,s.value="",i.value=!0};return{move:d=>{const v=d.touches[0];o.value=(v.clientX<0?0:v.clientX)-e.value,l.value=v.clientY-t.value,n.value=Math.abs(o.value),a.value=Math.abs(l.value);const I=10;(!s.value||n.value<I&&a.value<I)&&(s.value=Pe(n.value,a.value)),i.value&&(n.value>A||a.value>A)&&(i.value=!1)},start:d=>{u(),e.value=d.touches[0].clientX,t.value=d.touches[0].clientY},reset:u,startX:e,startY:t,deltaX:o,deltaY:l,offsetX:n,offsetY:a,direction:s,isVertical:P,isHorizontal:O,isTap:i}}let w=0;const D="van-overflow-hidden";function be(e,t){const o=we(),l="01",n="10",a=u=>{o.move(u);const h=o.deltaY.value>0?n:l,b=de(u.target,e.value),{scrollHeight:d,offsetHeight:v,scrollTop:I}=b;let f="11";I===0?f=v>=d?"00":"01":I+v>=d&&(f="10"),f!=="11"&&o.isVertical()&&!(parseInt(f,2)&parseInt(h,2))&&X(u,!0)},s=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",a,{passive:!1}),w||document.body.classList.add(D),w++},i=()=>{w&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",a),w--,w||document.body.classList.remove(D))},P=()=>t()&&s(),O=()=>t()&&i();ue(P),R(O),J(O),x(t,u=>{u?s():i()})}function V(e){const t=r(!1);return x(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const j=Symbol();function Re(e){const t=Q(j,null);t&&x(t,o=>{o&&e()})}const[Se,ke]=$("overlay"),xe={show:Boolean,zIndex:k,duration:k,className:N,lockScroll:C,lazyRender:C,customStyle:Object};var Te=p({name:Se,props:xe,setup(e,{slots:t}){const o=r(),l=V(()=>e.show||!e.lazyRender),n=s=>{e.lockScroll&&X(s,!0)},a=l(()=>{var s;const i=z(ve(e.zIndex),e.customStyle);return M(e.duration)&&(i.animationDuration=`${e.duration}s`),L(m("div",{ref:o,style:i,class:[ke(),e.className]},[(s=t.default)==null?void 0:s.call(t)]),[[Y,e.show]])});return K("touchmove",n,{target:o}),()=>m(B,{name:"van-fade",appear:!0},{default:a})}});const ge=F(Te),ze=z({},Ce,{round:Boolean,position:g("center"),closeIcon:g("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:g("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Ee,_]=$("popup");var Ae=p({name:Ee,inheritAttrs:!1,props:ze,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:l}){let n,a;const s=r(),i=r(),P=V(()=>e.show||!e.lazyRender),O=ee(()=>{const c={zIndex:s.value};if(M(e.duration)){const y=e.position==="center"?"animationDuration":"transitionDuration";c[y]=`${e.duration}s`}return c}),u=()=>{n||(n=!0,s.value=e.zIndex!==void 0?+e.zIndex:Ie(),t("open"))},h=()=>{n&&me(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},b=c=>{t("clickOverlay",c),e.closeOnClickOverlay&&h()},d=()=>{if(e.overlay)return m(ge,{show:e.show,class:e.overlayClass,zIndex:s.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:b},{default:l["overlay-content"]})},v=c=>{t("clickCloseIcon",c),h()},I=()=>{if(e.closeable)return m(ye,{role:"button",tabindex:0,name:e.closeIcon,class:[_("close-icon",e.closeIconPosition),fe],classPrefix:e.iconPrefix,onClick:v},null)};let f;const H=()=>{f&&clearTimeout(f),f=setTimeout(()=>{t("opened")})},U=()=>t("closed"),Z=c=>t("keydown",c),G=P(()=>{var c;const{round:y,position:S,safeAreaInsetTop:T,safeAreaInsetBottom:W}=e;return L(m("div",ce({ref:i,style:O.value,role:"dialog",tabindex:0,class:[_({round:y,[S]:S}),{"van-safe-area-top":T,"van-safe-area-bottom":W}],onKeydown:Z},o),[(c=l.default)==null?void 0:c.call(l),I()]),[[Y,e.show]])}),E=()=>{const{position:c,transition:y,transitionAppear:S}=e,T=c==="center"?"van-fade":`van-popup-slide-${c}`;return m(B,{name:y||T,appear:S,onAfterEnter:H,onAfterLeave:U},{default:G})};return x(()=>e.show,c=>{c&&!n&&(u(),o.tabindex===0&&te(()=>{var y;(y=i.value)==null||y.focus()})),!c&&n&&(n=!1,t("close"))}),Oe({popupRef:i}),be(i,()=>e.show&&e.lockScroll),K("popstate",()=>{e.closeOnPopstate&&(h(),a=!1)}),oe(()=>{e.show&&u()}),ne(()=>{a&&(t("update:show",!0),a=!1)}),R(()=>{e.show&&e.teleport&&(h(),a=!0)}),ae(j,()=>e.show),()=>e.teleport?m(se,{to:e.teleport},{default:()=>[d(),E()]}):m(le,null,[d(),E()])}});const pe=F(Ae);export{pe as P,Re as o,Ce as p,Oe as u};
