import{J as Pe,K as Ee,v as ae,M as Le,N as Te,c as K,m as k,n as w,t as Me,b as M,e as B,O as Ae,P as Be,r as S,I as A,w as Re,o as _e,Q as $e,R as Ne,x as De,S as Oe,T as Z,U as ze,V as F,l as p,W as We,i as qe}from"./index.71b9cbcb.js";import{d as H,q as o,P as Fe,Q as le,r as j,c as T,R as je,B as Ue,o as Ke,E as O,D as ie,v as He,S as Je}from"./entry.846cef3d.js";import{u as re,p as Qe,P as Ye}from"./index.092e994c.js";function oe(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Ge(e,n){if(oe(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function Xe(e,n){return new Promise(a=>{const u=n.validator(e,n);if(Le(u)){u.then(a);return}a(u)})}function ee(e,n){const{message:a}=n;return Te(a)?a(e,n):a||""}function Ze({target:e}){e.composing=!0}function te({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function pe(e,n){const a=Pe();e.style.height="auto";let u=e.scrollHeight;if(ae(n)){const{maxHeight:l,minHeight:d}=n;l!==void 0&&(u=Math.min(u,l)),d!==void 0&&(u=Math.max(u,d))}u&&(e.style.height=`${u}px`,Ee(a))}function et(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function y(e){return[...e].length}function U(e,n){return[...e].slice(0,n).join("")}const[tt,V]=K("cell"),ce={tag:k("div"),icon:String,size:String,title:w,value:w,label:w,center:Boolean,isLink:Boolean,border:Me,required:Boolean,iconPrefix:String,valueClass:M,labelClass:M,titleClass:M,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},nt=B({},ce,Ae);var at=H({name:tt,props:nt,setup(e,{slots:n}){const a=Be(),u=()=>{if(n.label||S(e.label))return o("div",{class:[V("label"),e.labelClass]},[n.label?n.label():e.label])},l=()=>{var c;if(n.title||S(e.title)){const h=(c=n.title)==null?void 0:c.call(n);return Array.isArray(h)&&h.length===0?void 0:o("div",{class:[V("title"),e.titleClass],style:e.titleStyle},[h||o("span",null,[e.title]),u()])}},d=()=>{const c=n.value||n.default;if(c||S(e.value))return o("div",{class:[V("value"),e.valueClass]},[c?c():o("span",null,[e.value])])},R=()=>{if(n.icon)return n.icon();if(e.icon)return o(A,{name:e.icon,class:V("left-icon"),classPrefix:e.iconPrefix},null)},E=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const c=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return o(A,{name:c,class:V("right-icon")},null)}};return()=>{var c;const{tag:h,size:f,center:z,border:_,isLink:W,required:C}=e,I=(c=e.clickable)!=null?c:W,L={center:z,required:C,clickable:I,borderless:!_};return f&&(L[f]=!!f),o(h,{class:V(L),role:I?"button":void 0,tabindex:I?0:void 0,onClick:a},{default:()=>{var x;return[R(),l(),d(),E(),(x=n.extra)==null?void 0:x.call(n)]}})}}});let lt=0;function it(){const e=Fe(),{name:n="unknown"}=(e==null?void 0:e.type)||{};return`${n}-${++lt}`}const rt=Re(at),[ot,b]=K("field"),ct={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:w,formatter:Function,clearIcon:k("clear"),modelValue:De(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,spellcheck:{type:Boolean,default:null},clearTrigger:k("focus"),formatTrigger:k("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},st=B({},ce,ct,{rows:w,type:k("text"),rules:Array,autosize:[Boolean,Object],labelWidth:w,labelClass:M,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var xt=H({name:ot,props:st,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a}){const u=it(),l=le({status:"unvalidated",focused:!1,validateMessage:""}),d=j(),R=j(),E=j(),{parent:c}=_e(Oe),h=()=>{var t;return String((t=e.modelValue)!=null?t:"")},f=t=>{if(S(e[t]))return e[t];if(c&&S(c.props[t]))return c.props[t]},z=T(()=>{const t=f("readonly");if(e.clearable&&!t){const r=h()!=="",i=e.clearTrigger==="always"||e.clearTrigger==="focus"&&l.focused;return r&&i}return!1}),_=T(()=>E.value&&a.input?E.value():e.modelValue),W=t=>t.reduce((r,i)=>r.then(()=>{if(l.status==="failed")return;let{value:s}=_;if(i.formatter&&(s=i.formatter(s,i)),!Ge(s,i)){l.status="failed",l.validateMessage=ee(s,i);return}if(i.validator)return oe(s)&&i.validateEmpty===!1?void 0:Xe(s,i).then(g=>{g&&typeof g=="string"?(l.status="failed",l.validateMessage=g):g===!1&&(l.status="failed",l.validateMessage=ee(s,i))})}),Promise.resolve()),C=()=>{l.status="unvalidated",l.validateMessage=""},I=()=>n("endValidate",{status:l.status,message:l.validateMessage}),L=(t=e.rules)=>new Promise(r=>{C(),t?(n("startValidate"),W(t).then(()=>{l.status==="failed"?(r({name:e.name,message:l.validateMessage}),I()):(l.status="passed",r(),I())})):r()}),x=t=>{if(c&&e.rules){const{validateTrigger:r}=c.props,i=Z(r).includes(t),s=e.rules.filter(g=>g.trigger?Z(g.trigger).includes(t):i);s.length&&L(s)}},se=t=>{var r;const{maxlength:i}=e;if(S(i)&&y(t)>+i){const s=h();if(s&&y(s)===+i)return s;const g=(r=d.value)==null?void 0:r.selectionEnd;if(l.focused&&g){const m=[...t],v=m.length-+i;return m.splice(g-v,v),m.join("")}return U(t,+i)}return t},$=(t,r="onChange")=>{const i=t;t=se(t);const s=y(i)-y(t);if(e.type==="number"||e.type==="digit"){const m=e.type==="number";t=ze(t,m,m)}let g=0;if(e.formatter&&r===e.formatTrigger){const{formatter:m,maxlength:v}=e;if(t=m(t),S(v)&&y(t)>+v&&(t=U(t,+v)),d.value&&l.focused){const{selectionEnd:D}=d.value,X=U(i,D);g=y(m(X))-y(X)}}if(d.value&&d.value.value!==t)if(l.focused){let{selectionStart:m,selectionEnd:v}=d.value;if(d.value.value=t,S(m)&&S(v)){const D=y(t);s?(m-=s,v-=s):g&&(m+=g,v+=g),d.value.setSelectionRange(Math.min(m,D),Math.min(v,D))}}else d.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},ue=t=>{t.target.composing||$(t.target.value)},q=()=>{var t;return(t=d.value)==null?void 0:t.blur()},J=()=>{var t;return(t=d.value)==null?void 0:t.focus()},N=()=>{const t=d.value;e.type==="textarea"&&e.autosize&&t&&pe(t,e.autosize)},de=t=>{l.focused=!0,n("focus",t),O(N),f("readonly")&&q()},fe=t=>{l.focused=!1,$(h(),"onBlur"),n("blur",t),!f("readonly")&&(x("onBlur"),O(N),We())},Q=t=>n("clickInput",t),ge=t=>n("clickLeftIcon",t),me=t=>n("clickRightIcon",t),he=t=>{F(t),n("update:modelValue",""),n("clear",t)},Y=T(()=>{if(typeof e.error=="boolean")return e.error;if(c&&c.props.showError&&l.status==="failed")return!0}),be=T(()=>{const t=f("labelWidth"),r=f("labelAlign");if(t&&r!=="top")return{width:p(t)}}),ve=t=>{t.keyCode===13&&(!(c&&c.props.submitOnEnter)&&e.type!=="textarea"&&F(t),e.type==="search"&&q()),n("keypress",t)},G=()=>e.id||`${u}-input`,ye=()=>l.status,Se=()=>{const t=b("control",[f("inputAlign"),{error:Y.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return o("div",{class:t,onClick:Q},[a.input()]);const r={id:G(),ref:d,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:f("disabled"),readonly:f("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${u}-label`:void 0,onBlur:fe,onFocus:de,onInput:ue,onClick:Q,onChange:te,onKeypress:ve,onCompositionend:te,onCompositionstart:Ze};return e.type==="textarea"?o("textarea",r,null):o("input",ie(et(e.type),r),null)},ke=()=>{const t=a["left-icon"];if(e.leftIcon||t)return o("div",{class:b("left-icon"),onClick:ge},[t?t():o(A,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},we=()=>{const t=a["right-icon"];if(e.rightIcon||t)return o("div",{class:b("right-icon"),onClick:me},[t?t():o(A,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Ce=()=>{if(e.showWordLimit&&e.maxlength){const t=y(h());return o("div",{class:b("word-limit")},[o("span",{class:b("word-num")},[t]),He("/"),e.maxlength])}},Ie=()=>{if(c&&c.props.showErrorMessage===!1)return;const t=e.errorMessage||l.validateMessage;if(t){const r=a["error-message"],i=f("errorMessageAlign");return o("div",{class:b("error-message",i)},[r?r({message:t}):t])}},xe=()=>{const t=f("labelWidth"),r=f("labelAlign"),i=f("colon")?":":"";if(a.label)return[a.label(),i];if(e.label)return o("label",{id:`${u}-label`,for:a.input?void 0:G(),onClick:s=>{F(s),J()},style:r==="top"&&t?{width:p(t)}:void 0},[e.label+i])},Ve=()=>[o("div",{class:b("body")},[Se(),z.value&&o(A,{ref:R,name:e.clearIcon,class:b("clear")},null),we(),a.button&&o("div",{class:b("button")},[a.button()])]),Ce(),Ie()];return re({blur:q,focus:J,validate:L,formValue:_,resetValidation:C,getValidationStatus:ye}),je($e,{customValue:E,resetValidation:C,validateWithTrigger:x}),Ue(()=>e.modelValue,()=>{$(h()),C(),x("onChange"),O(N)}),Ke(()=>{$(h(),e.formatTrigger),O(N)}),Ne("touchstart",he,{target:T(()=>{var t;return(t=R.value)==null?void 0:t.$el})}),()=>{const t=f("disabled"),r=f("labelAlign"),i=ke(),s=()=>{const g=xe();return r==="top"?[i,g].filter(Boolean):g||[]};return o(rt,{size:e.size,class:b({error:Y.value,disabled:t,[`label-${r}`]:r}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:be.value,valueClass:b("value"),titleClass:[b("label",[r,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:i&&r!=="top"?()=>i:null,title:s,value:Ve,extra:a.extra})}}});function ut(){const e=le({show:!1}),n=l=>{e.show=l},a=l=>{B(e,l,{transitionAppear:!0}),n(!0)},u=()=>n(!1);return re({open:a,close:u,toggle:n}),{open:a,close:u,state:e,toggle:n}}function dt(e){const n=Je(e),a=document.createElement("div");return document.body.appendChild(a),{instance:n.mount(a),unmount(){n.unmount(),document.body.removeChild(a)}}}const[ft,gt]=K("notify"),mt=B({},Qe,{type:k("danger"),color:String,message:w,position:k("top"),className:M,background:String,lockScroll:Boolean});var ht=H({name:ft,props:mt,emits:["update:show"],setup(e,{emit:n,slots:a}){const u=l=>n("update:show",l);return()=>o(Ye,{show:e.show,class:[gt([e.type]),e.className],style:{color:e.color,background:e.background},overlay:!1,zIndex:e.zIndex,position:e.position,duration:.2,lockScroll:e.lockScroll,"onUpdate:show":u},{default:()=>[a.default?a.default():e.message]})}});let ne,P;const bt=e=>ae(e)?e:{message:e};function vt(){({instance:P}=dt({setup(){const{state:e,toggle:n}=ut();return()=>o(ht,ie(e,{"onUpdate:show":n}),null)}}))}const yt=()=>({type:"danger",color:void 0,message:"",onClose:void 0,onClick:void 0,onOpened:void 0,duration:3e3,position:void 0,className:"",lockScroll:!1,background:void 0});let St=yt();const kt=()=>{P&&P.toggle(!1)};function Vt(e){if(qe)return P||vt(),e=B({},St,bt(e)),P.open(e),clearTimeout(ne),e.duration>0&&(ne=setTimeout(kt,e.duration)),P}export{xt as a,dt as m,Vt as s,ut as u};
